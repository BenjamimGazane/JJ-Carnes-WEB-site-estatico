<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <title>Recibo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="style2.css">
</head>
<body>
  <div class="container">
    <h2 class="text-danger">Recibo - JJ Carnes</h2>
    <p>Data: <span id="dataAtual"></span></p>

    <table class="table table-bordered mt-4">
      <thead class="table-danger">
        <tr>
          <th>Produto</th>
          <th>Preço</th>
          <th>Quantidade</th>
          <th>Subtotal</th>
        </tr>
      </thead>
      <tbody id="tabelaItens"></tbody>
    </table>
    <h5 class="text-end" style="margin-bottom: 2rem;">Total: <span id="totalCompra"></span> Mts</h5>
    
    <h5 class="text-start" style="color: red;">Clique no Botao e envie os dados do pedido no whatsapp</h5>
    <a id="whatsapp-btn" target="_blank" class="btn btn-success d-flex align-items-center gap-2 mb-3">
  <svg xmlns="http://www.w3.org/2000/svg" width="45" height="45" fill="white" viewBox="0 0 24 24">
    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.031-.967-.273-.099-.472-.148-.67.15s-.767.966-.94 1.164c-.173.199-.347.223-.644.075-.297-.149-1.255-.462-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.298-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.372-.025-.521-.075-.148-.669-1.611-.916-2.204-.242-.58-.487-.501-.67-.51-.173-.007-.372-.009-.571-.009-.198 0-.52.074-.792.372-.272.298-1.04 1.016-1.04 2.479s1.065 2.876 1.213 3.074c.149.198 2.096 3.2 5.076 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.872.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.288.173-1.413-.074-.124-.272-.198-.57-.347zm-5.421 7.617h-.002a9.87 9.87 0 0 1-5.031-1.378l-.361-.214-3.741.982.998-3.647-.235-.374a9.86 9.86 0 0 1-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 0 1 2.893 6.991c-.003 5.45-4.437 9.884-9.887 9.884zm8.413-18.297a11.815 11.815 0 0 0-8.411-3.502c-6.531 0-11.846 5.316-11.849 11.847a11.82 11.82 0 0 0 1.632 6.003L.26 23.755a.752.752 0 0 0 .927.928l5.706-1.523a11.816 11.816 0 0 0 5.157 1.238h.005c6.531 0 11.846-5.316 11.849-11.847a11.82 11.82 0 0 0-3.501-8.412z"/>
  </svg>
  Enviar por WhatsApp
</a>

    <h5 class="text-start" style="color: red;">Baixe o recibo para salvar seus dados</h5>
    <button onclick="gerarReciboPDF()" class="btn btn-success mb-4">
  <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="white" class="me-1" viewBox="0 0 16 16">
    <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.6A1 1 0 0 0 2.5 14h11a1 1 0 0 0 1-1v-2.6a.5.5 0 0 1 1 0v2.6a2 2 0 0 1-2 2H2.5a2 2 0 0 1-2-2v-2.6a.5.5 0 0 1 .5-.5z"/>
    <path d="M7.646 10.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 9.293V1.5a.5.5 0 0 0-1 0v7.793L5.354 7.146a.5.5 0 1 0-.708.708l3 3z"/>
  </svg>
  Baixar Recibo (PDF)
</button>
  </div>
  <script src="script.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <script>
    const dados = JSON.parse(localStorage.getItem("dadosCarrinho")) || [];
    
    // Agrupar por nome
    const agrupados = {};
    dados.forEach(item => {
      if (agrupados[item.nome]) {
        agrupados[item.nome].quantidade++;
      } else {
        agrupados[item.nome] = { ...item, quantidade: 1 };
      }
    });

    // Popular tabela
    const corpo = document.getElementById("tabelaItens");
    let total = 0;

    Object.values(agrupados).forEach(item => {
      const preco = parseInt(item.preco.replace(/\D/g, ""));
      const subtotal = preco * item.quantidade;
      total += subtotal;

      corpo.innerHTML += `
        <tr>
          <td>${item.nome}</td>
          <td>${item.preco}</td>
          <td>${item.quantidade}</td>
          <td>${subtotal} Mts</td>
        </tr>
      `;
    });

    // Exibir total
    document.getElementById("totalCompra").textContent = total;
    enviarWhatsApp();

    // Exibir data
    document.getElementById("dataAtual").textContent = new Date().toLocaleDateString();

    function enviarWhatsApp() {
  const data = new Date().toLocaleDateString();
  let mensagem = `*Recibo JJ Carnes*%0AData: ${data}%0A%0A`;

  Object.values(agrupados).forEach(item => {
    const preco = parseInt(item.preco.replace(/\D/g, ""));
    const subtotal = preco * item.quantidade;

    mensagem += `• ${item.nome} - ${item.quantidade} unidade(s) = ${subtotal} Mts%0A`;
  });

  mensagem += `%0A*Total:* ${total} Mts%0AObrigado pela preferência!`;

  const numero = "258846828130";//número do fornecedor aqui
  const link = `https://wa.me/${numero}?text=${mensagem}`;

  // Aplica no botão
  document.getElementById("whatsapp-btn").href = link;
}
  </script>
</body>
</html>